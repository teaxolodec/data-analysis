# Описание проекта
Подготовим прототип модели машинного обучения для «Цифры», компании, разрабатывающей решения для повышения эффективности работы промышленых предприятий.

Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды, что необходимо для того чтобы топтимизировать производство и не запускать предприятие с убыточными характеристиками. Для решения этой задачи в нашем распоряжении есть данные с параметрами добычи и очистки.

## Технологический процесс
Когда добытая руда проходит первичную обработку, получается дроблёная смесь. Её отправляют на флотацию (обогащение) и двухэтапную очистку.

Опишем каждую стадию: 
1. **Флотация**
Во флотационную установку подаётся смесь золотосодержащей руды. После обогащения получается черновой концентрат и «отвальные хвосты», то есть остатки продукта с низкой концентрацией ценных металлов.
На стабильность этого процесса влияет непостоянное и неоптимальное физико-химическое состояние флотационной пульпы (смеси твёрдых частиц и жидкости).
2. **Очистка**
Черновой концентрат проходит две очистки. На выходе получается финальный концентрат и новые отвальные хвосты. Чтобы получить финальный концентрат руда проходит два этапа очистки.

### Описание данных
#### Технологический процесс
- `Rougher feed` — исходное сырье
- `Rougher additions` — флотационные реагенты: `Xanthate`, `Sulphate`, `Depressant`
- `Rougher process` — флотация
- `Rougher tails` — отвальные хвосты
- `Float banks` — флотационная установка
- `Cleaner process` — очистка
- `Rougher Au` — черновой концентрат золота
- `Final Au` — финальный концентрат золота
#### Параметры этапов
- `air amount` — объём воздуха
- `fluid levels` — уровень жидкости
- `feed size` — размер гранул сырья
- `feed rate` — скорость подачи

Данные находятся в трёх файлах:  
- `gold_industry_train.csv` — обучающая выборка;  
- `gold_industry_test.csv` — тестовая выборка;  
- `gold_industry_full.csv` — исходные данные.
При этом `gold_industry_full.csv` является объединением `gold_industry_train.csv` и `gold_industry_test.csv` и не загружен в данный проект из-за большого объёма.
Данные индексируются датой и временем получения информации (признак `date`).
Некоторые параметры в `gold_industry_test.csv` недоступны, потому что замеряются и/или рассчитываются значительно позже. Из-за этого в тестовой выборке отсутствуют некоторые признаки, которые могут быть в обучающей. Также в тестовом наборе нет целевых признаков.
Исходный датасет содержит обучающую и тестовую выборки со всеми признаками.

### Наименование признаков
Наименование признаков задаётся следующим образом:  
`[этап].[тип_параметра].[название_параметра]`

### Расчёт эффективности
Эффективность обогащения $R$ рассчитывается по формуле:
$$R = \frac{C (F - T)}{F (C - T)}$$
где  
$C$ — доля золота в концентрате после флотации/очистки;  
$F$ — доля золота в сырье/концентрате до флотации/очистки;  
$T$ — доля золота в отвальных хвостах после флотации/очистки.

Для прогноза коэффициента нужно найти долю золота в концентратах и хвостах. Причём важен не только финальный продукт, но и черновой концентрат.

### Расчёт эффективности
Для решения задачи введём новую метрику качества — sMAPE (симметричное среднее абсолютное процентное отклонение). Данная метрика одинаково учитывает масштаб и целевого признака и предсказания. При этом она вычислияется следующим образом:
$$sMAPE = \frac{1}{N} \sum_{i=1}^{N}{\frac{2 |y_i - \hat y_i|}{|y_i| + |\hat y_i|}}$$
где  
$y_i$ — значение целевого признака для объекта с порядковым номером i в выборке, на которой измеряется качество;  
$\hat y_i$ — значение предсказания для объекта с порядковым номером i, например, в тестовой выборке.

Нужно спрогнозировать сразу две величины:  
- эффективность обогащения чернового концентрата `rougher.output.recovery`;  
- эффективность обогащения финального концентрата `final.output.recovery`.  
Итоговая метрика складывается из двух величин:
$$Итоговый \space sMAPE = 0.25 \cdot sMAPE(rougher) + 0.75 \cdot sMAPE(final)$$

## Навыки и инструменты
- python
- pandas
- numpy
- matplotlib
- sklearn
  - DecisionTreeRegressor
  - KNeighborsRegressor
  - LinearRegression
  - RandomForestRegressor
  - SVR
  - DecisionTreeRegressor
